# 项目信息
## 项目名
**鸡地求生 (POBG)**
<br>（来自选题“鸡地求生”）

## 项目成员 & 贡献比

|姓名 | 学号 | 贡献比<br>以平均值为100% | 贡献比<br>以总分为100% | 班级 |
| --- | --- | :-----: | :----: | :---: |
| 蔡明宏 | 2053769 | 100% | 25% | 朱老师 |
| 方新宇 | 2052324 | 100% | 25% | 朱老师 |
| 彭浩 | 2053380 | 100% | 25% | 朱老师 |
| 张子涵 | 2054192 | 100% | 25% | 朱老师 |

（按姓氏首字母排名）

## 项目地址

https://github.com/PengH-China/FInal-project

## 进度时间线
| 日期 | 功能 |
| :---:  | ---- |
| 5.10	| 各自学习cocos2dx语法以及部分C++知识，对cocos2dx有初步了解  （*初步规划、项目大致分工（约两周时间）*） |
| 5.20	| 游戏菜单的创建，音效和音乐的设置，完成界面内英雄的选择； |
| 5.29	| 分工细化，开始最基础类的设计以及对应的基础功能，完成基本框架的搭建 *（并列完成人物、武器、子弹、地图）* |
| 6.2	| 个人所负责部分的合成与调试，比如人物与武器的交互、子弹的产生等等 |
| 6.3	| 由于英雄类的动作难以实现，进行对英雄类的逻辑重写 |
| 6.5	| 物理世界的引入与搭建，对各个物品加上物理属性（PhysicalBody），以及它们碰撞回调与交互（OnContactBegin函数） |
| 6.8	| 子弹方向的确立，判断鼠标的位置与英雄位置；添加GlobalParameter到项目 |
| 6.10	| 怪物的产生与回调函数的添加，完善英雄与怪物的交互，障碍物的设定 |
| 6.15	| 障碍物的最终设立，对人物进行位置回退 |
| 6.16 | 游戏逻辑的添加，如宝箱的生成                                 |
| 6.17 | 英雄与怪物的属性建立，根据属性对onContactBegin函数的增改     |
| 6.18 | 完成武器的捡起与掉落，开箱的动作和怪物随机生成               |
| 6.19 | 菜单界面的功能必要性添加，游戏内暂停界面的添加，调试后细节内容修改 |
| 6.20 | 计时器的开发与应用，音效的全面添加与使用，游戏逻辑的深层次改进，开挂系统的创立与完善，c++特性的添加，代码规范性的完善 |
| 后续 | 修复各种ddl前bug以及写新的bug                                |




# 项目开发

## 注意事项
暂无

## 1. 架构设计
### 基类
+ Role
+ Item
+ Scene
+ Bullet
+ Monster
+ Weapon

具体类在代码中体现，一般一个文件 (.h + .cpp) 就是一个类。

## 2.分工

| 组员 | 完成项 |
| --- |  :---: |
| 蔡明宏 | 人物、武器、子弹、物理引擎（碰撞所需）、后期测试与整合 |
| 方新宇 | 场景、UI、交互、地图绘制（学习Tiled软件）、素材寻找、后期测试与整合 |
| 彭浩 | 人物、怪物、宝箱、素材寻找、美工（设计素材）、后期测试与整合 |
| 张子涵 | 开始界面、人物、AI英雄、物理引擎、全局变量控制，后期测试与整合 |



## 3.基础功能（基础项）：

2.怪物随机位置生成，随机种类，随机移动，监测人物位置，靠近后会接近人物。四种怪物。两个远程怪在一定范围内运动，不靠近人物，进程会到人物附近并攻击
3.UI开始界面自定义播放音量、音效、在游戏运行时随时设定音量与音效（全局性）
4.宝箱随机位置生成，随机种类，（共有3种枪，两种子弹，一个医疗包，一个扩容弹夹）以增强游戏平衡性
5.武器：多种武器，与人物建立关系，随人物移动，改变自身方位

## 4.创新功能：

##### 1.物理引擎

人物、怪物碰到障碍物无法穿过：物理世界的创建，物体的碰撞后分辨获取节点，后对不同节点操作，获取障碍物和人物Tag，然后执行相应逻辑

##### 2.捡枪和子弹、换枪（支持重复操作）、开箱子、叠buff

在weapon与box中实时监测人物位置并添加键盘监听事件，监听到后与人物产生交互。扔枪后重新设置位置并与人物脱离关系，保留子弹信息

##### 3.实时显示时间、子弹数、血量（人物与怪物均有）、防御等UI信息

根据运行时间设置是否填充新怪物（宝箱会一直填充），利用ProgressTimer进行血条等的设定，在UI的update里实时获取人物属性并进行更新。

##### 4.大地图

整体视角随人物移动而改变：
在层中构建地图，通过人物实时坐标获取，达成整层的刚体及地图本身实时交互移动

##### 5.其他：

每个动作都有对应音效（如碰墙、换枪、射击、开箱、受伤），游戏总时间设定、可在任意地方回到游戏开始主界面，多个按钮实现各项交互，创建const文件方便管理常变量，创建GlobalPara方便跨文件得到实例化对象

## 5.经典难点及解决
1. ##### 无法解析的外部解析符号：主要有这几个问题：

   1.静态变量没有初始化  2.虚函数仅定义但没有实现  3.资源文件路径名错误  4.头文件相互包含

2. ##### 整体宏不定义：头文件相互包含，导致整个头文件无效，

   解决：通过在cpp中减少头文件的include，尽量仅包含本文件的头文件，在头文件中尽量减少无效头文件include（找起来还是很麻烦的）

3. ##### Update函数不执行：

   主要是因为一开始有几个update函数没加参数，但是scheduleUpdate会自动执行带有float参数的update函数，如果没有参数的话，相当于进行了函数重载，无法指定想要执行的函数

4. ##### 什么时候retain：

   要想让对象参与内存管理机制，必须继承CCObject类（CCNode、CCLayer等都继承了CCObject类）。然后，调用对象的autoRelease函数，这样在游戏的每一帧，内存管理机制都会扫描一遍被调用autoRelease的对象，一旦发现对象无人认领，就会将对象消除。如果不想让对象被杀死，那么就要调用对象的retain函数，这样对象就被认领了，一旦对象被认领，就永远不会被内存管理机制杀掉， 对象一直都不被释放的话，那么就会产生内存泄露，因此，当你不需要再使用这个对象时，就要调用对象的release函数（比较重要的一点:调用addchild函数的时候，会自动调用retain函数从而延长该对象生存期）

## 6.基本项
除联机外已全部完成

## 7.加分项
+ 作弊按钮（无限血，无限子弹）
+ 各项动作及不同攻击方式有不同音效
+ 多样buff ，由宝箱实现

## 8.C++11 特性
* 虚函数
* lambda 表达式
* 类型推断（auto）
* 设置命名空间
* 右值引用
* ........

## 9.操纵
| 键 | 动作 |
| --- | --- |
| 游戏中：||
| 鼠标左键单击           |      射击|
| WASD键/上下左右键  |               移动|
| E键            | 拾取武器（切换武器），开箱 |
| SPACE键       | 人物快速移动(翻滚) |
| R键               | 装弹 |
## End.学习到了

* **版本控制（GitHub）：**
  多方代码
  实时更新同步
  带来巨大方便
* **团队协作：**
  We are a team
  同舟共济！！
  相互帮助（修bug）
  共同进步（想逻辑）
* **大型项目经验：**
  对于复杂类的整体设计，如何高内聚低耦合，与逻辑上关系很近的其他类的联系
* ........